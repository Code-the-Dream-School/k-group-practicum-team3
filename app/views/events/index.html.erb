<h1>Events</h1>

<table border="1" cellpadding="8" cellspacing="0" width="100%">
  <thead>
    <tr>
      <th>Event Info</th>
      <th>Details</th>
      <th>Actions</th>
    </tr>
  </thead>

  <tbody>
    <% @events.each do |event| %>
      <tr>
        <!-- Event Info -->
        <td>
          <p><strong>Title:</strong> <%= event.title %></p>
          <p><strong>Category:</strong> <%= event.category.titleize %></p>
          <p><strong>Organizer:</strong> <%= event.organizer&.name || event.organizer&.email %></p>
        </td>

        <!-- Details -->
        <td>
          <p>
            <strong>Location:</strong>
            <%= event.city.presence || "Online / N/A" %>
          </p>

          <p>
            <strong>Event Time:</strong>
            <%= event.starts_at.strftime("%Y-%m-%d %I:%M %p") if event.starts_at %>
          </p>

          <p>
            <strong>Age Range:</strong>
            <% if event.age_min.present? || event.age_max.present? %>
              <%= event.age_min || "?" %> â€“ <%= event.age_max || "?" %>
            <% else %>
              Any
            <% end %>
          </p>
		
          <p><strong>Gender:</strong> <%= event.allowed_gender.humanize %></p>
			 
          <p>
            <strong>Description:</strong><br>
            <%= truncate(event.description, length: 100) %>
          </p>
        </td>

        <!-- Actions -->
        <td>
          <p><%= link_to "Show", event_path(event) %></p>

          <% if current_user&.admin? || current_user&.id == event.organizer_id %>
            <p><%= link_to "Edit", edit_event_path(event) %></p>
            <p>
              <%= link_to "Delete", event_path(event),
                    method: :delete,
                    data: { turbo_confirm: "Are you sure you want to delete this event?" } %>
            </p>
          <% else %>
            <p style="color: gray;">Not allowed</p>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<div>
  <%= link_to "Create New Event", new_event_path %>
</div>